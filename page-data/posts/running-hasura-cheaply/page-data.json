{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/running-hasura-cheaply","result":{"data":{"markdownRemark":{"id":"fc280f19-e7ae-553b-bb35-c8a60b7f86fd","html":"<ul>\n<li><a href=\"#self-hosting-hasura-graphql-engine-on-digitalocean\">Self-Hosting Hasura GraphQL Engine on DigitalOcean</a></li>\n<li><a href=\"#hosting-a-postgres-database-on-heroku\">Hosting a Postgres Database on Heroku</a></li>\n<li><a href=\"#the-biggest-issue-with-these-hosting-choices\">The Biggest Issue With These Hosting Choices</a></li>\n</ul>\n<h2 id=\"whats-hasura\" style=\"position:relative;\"><a href=\"#whats-hasura\" aria-label=\"whats hasura permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What’s Hasura?</h2>\n<p><a href=\"https://hasura.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hasura</a> is the company that created the <a href=\"https://github.com/hasura/graphql-engine#hasura-graphql-engine\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hasura GraphQL Engine</a>, a “blazing-fast GraphQL server that gives you instant, realtime GraphQL APIs over Postgres.” (For this blog post, I may use “Hasura” and “Hasura GraphQL Engine” interchangeably because this post is about self-hosting their GraphQL engine. But Hasura the company offers more than just their GraphQL engine.)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrUlEQVQoz4VSbW/TMBDO/xcSEhIv4ofAStcAiTbBCqtSpd3ajamq+MC6oobY8cudz+YcrxA+cbJOzuUeP89zdlZV1W63CyF47wHAOccZEZ1DiIHB0w9ly/u2uG+XjdJKd50iIoZkD/u9EIJ3dAzGD/bc5BuL9UHVh24rDR9prWWmCA7/C3Ce+tYUPi6flGbTy/msWnyZzTfb76mU4rgPGr1CshgcecNenItV34PHeVmeT0eTcn1zp41phXTp9/Eg/jCODsbutdHoEn2KCB5NilFevB1/KM4+v8tLtvQo7yhBgH1Q2jr/C1wHhNRTh8R8dsHkl1VdnF+cnH5crm4H+qNadMRIzeIdSUsSyCAXfTabLxZX66q+uvm2qZer6dfqbrMdmucmBrfgPv3sGj7Dh8a4XYcKKBNd10opleLMno2xf2fWZyBSwErpVpi9RotkIPI7z1dlKK5454GfRnonQ2bmUhArmqJbiDf/6CV7snjz/Pr02fX4xXoi0QxH9WdgacAtEiMNZ0BrWQxlT5cnr9fvX67yV6tcgI5Pzf8TBOgtSiTB7kPoLDaybyP/G90hq6FfBbB5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bdaf6935507aea31c799075b0576efc0/60a22/hasura-landing.webp 160w,\n/static/bdaf6935507aea31c799075b0576efc0/4c812/hasura-landing.webp 320w,\n/static/bdaf6935507aea31c799075b0576efc0/0ba47/hasura-landing.webp 640w,\n/static/bdaf6935507aea31c799075b0576efc0/e46b2/hasura-landing.webp 960w,\n/static/bdaf6935507aea31c799075b0576efc0/af3f0/hasura-landing.webp 1280w,\n/static/bdaf6935507aea31c799075b0576efc0/9b34b/hasura-landing.webp 2418w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bdaf6935507aea31c799075b0576efc0/69538/hasura-landing.png 160w,\n/static/bdaf6935507aea31c799075b0576efc0/72799/hasura-landing.png 320w,\n/static/bdaf6935507aea31c799075b0576efc0/6af66/hasura-landing.png 640w,\n/static/bdaf6935507aea31c799075b0576efc0/d9199/hasura-landing.png 960w,\n/static/bdaf6935507aea31c799075b0576efc0/21b4d/hasura-landing.png 1280w,\n/static/bdaf6935507aea31c799075b0576efc0/12c06/hasura-landing.png 2418w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bdaf6935507aea31c799075b0576efc0/6af66/hasura-landing.png\"\n            alt=\"Hasura Landing Page\"\n            title=\"Hasura Landing Page\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>You can use the Hasura GUI to create Postgres tables and easily do standard Postgres things like set:</p>\n<ul>\n<li>columns</li>\n<li>constraints</li>\n<li>primary/foreign/unique keys</li>\n<li>table relationships</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.62500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7klEQVQoz4WQyW7DMAxE/f+/mB6aVLYsWxsparWdlE6TIi1cdPAOhMgZAdOpSQupNCZIzVNxVBnr0QGVtrZ1q+tW2nJIN07ThxCAiCF8ESjk5GKYY0TnwQPk2o7Ng5Sn05sc1fv50g9ykOOolLVGjj0nni+c3KdSj83Ww2ysttYC/7jUZb2zte3Gw7Jd1+s+HJuNsWpizZEiKxDthAe86vthnjUviX4SE5uNEMI5t5uIUkr5SeIsbgGRY/LL+2ObcgeAWmuuC+93pZT6FM/trnokPuwwkLGOK8ml/irmr5K/t7vZAUIgxmN4Nfxr/gSH9ASbq3TmFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c7e25c3b342181d5fb3d497a58af8bfc/60a22/hasura-table-relationships.webp 160w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/4c812/hasura-table-relationships.webp 320w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/0ba47/hasura-table-relationships.webp 640w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/e46b2/hasura-table-relationships.webp 960w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/af3f0/hasura-table-relationships.webp 1280w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/6f9cd/hasura-table-relationships.webp 1884w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c7e25c3b342181d5fb3d497a58af8bfc/69538/hasura-table-relationships.png 160w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/72799/hasura-table-relationships.png 320w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/6af66/hasura-table-relationships.png 640w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/d9199/hasura-table-relationships.png 960w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/21b4d/hasura-table-relationships.png 1280w,\n/static/c7e25c3b342181d5fb3d497a58af8bfc/0e0c4/hasura-table-relationships.png 1884w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c7e25c3b342181d5fb3d497a58af8bfc/6af66/hasura-table-relationships.png\"\n            alt=\"Table Relationships in Hasura\"\n            title=\"Table Relationships in Hasura\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>All this data is then accessible through a single GraphQL endpoint. You can use the integrated <a href=\"https://github.com/graphql/graphiql#overview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GraphiQL IDE</a> to write queries, mutations, and subscriptions. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQY022PSXKEMAxFuf8Zs6Gr0gEbjAdNHoloepPhlRaqsp6+NbXeS87BhzGG5PyY5+X5NMZs+6bsbr+bVTHGWrsuV6fNcRxTALKRxzgV9WMI7muvVIq0wrVJrZRb04jurDuOSCzIjHTVhJS3nYCK6r03YrZRPORe++jj7GM03TlUjhE+jfeLTzboCq1JqCTD5wtNEOYAEjGfP9EnZp5X//HYUoS3XGo1DpHrPUFEAaX38VdGos0nn5AlkwhJniRXlzjXfk8AgJq/1bfMLsDuEgTEiOjhStYTEpfWr8NKKed/vD6lMq42gA14JEL+Br/0lQDykqAyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/343ec047fa066862e82f131af49250b5/60a22/graphiql.webp 160w,\n/static/343ec047fa066862e82f131af49250b5/4c812/graphiql.webp 320w,\n/static/343ec047fa066862e82f131af49250b5/0ba47/graphiql.webp 640w,\n/static/343ec047fa066862e82f131af49250b5/e46b2/graphiql.webp 960w,\n/static/343ec047fa066862e82f131af49250b5/af3f0/graphiql.webp 1280w,\n/static/343ec047fa066862e82f131af49250b5/7da0b/graphiql.webp 2506w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/343ec047fa066862e82f131af49250b5/69538/graphiql.png 160w,\n/static/343ec047fa066862e82f131af49250b5/72799/graphiql.png 320w,\n/static/343ec047fa066862e82f131af49250b5/6af66/graphiql.png 640w,\n/static/343ec047fa066862e82f131af49250b5/d9199/graphiql.png 960w,\n/static/343ec047fa066862e82f131af49250b5/21b4d/graphiql.png 1280w,\n/static/343ec047fa066862e82f131af49250b5/16529/graphiql.png 2506w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/343ec047fa066862e82f131af49250b5/6af66/graphiql.png\"\n            alt=\"GraphiQL in Hasura\"\n            title=\"GraphiQL in Hasura\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Additionally, there are more advanced features like <a href=\"https://hasura.io/docs/latest/graphql/core/auth/authorization/permission-rules.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">permissioning</a>, <a href=\"https://hasura.io/docs/latest/graphql/core/databases/postgres/schema/custom-functions.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">custom SQL functions</a>, and <a href=\"https://hasura.io/docs/latest/graphql/core/event-triggers/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">event triggers</a>. Beyond their documentation, many of these topics are covered in <a href=\"https://hasura.io/learn/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">their extremely handy tutorials</a>.</p>\n<p>I’ve been building <a href=\"https://trivia.digital\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Trivia.Digital</a> with Hasura as my backend, and it’s made it very simple to configure my database and make my data accessible over a real-time GraphQL API. It’s <a href=\"https://hasura.io/opensource/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">open-source</a> and has <a href=\"https://hasura.io/docs/latest/graphql/core/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">great documentation</a> and I highly recommend it! As a relative noob to both Postgres and GraphQL, its UI is more beginner-friendly than a tool like <a href=\"https://www.graphile.org/postgraphile/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PostGraphile</a> (though I’ve heard many great things about PostGraphile).</p>\n<p>The biggest <em>potential</em> downside of Hasura is that it can be relatively expensive for a hobbyist to use it for a side project. But it doesn’t have to be that way! Because their GraphQL Engine is open-source, I’ve been running it on <a href=\"https://www.digitalocean.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DigitalOcean</a> for just $5/month.</p>\n<p><strong>This post explains how you, too, can run Hasura for $5/month while avoiding some potential pitfalls.</strong> <em>Caveat</em>: I am not an expert on any of these topics, so my apologies if I’ve gotten anything wrong. If you have any suggestions, please email me at bhollander823@gmail.com.</p>\n<p>Of course, this low bill is only possible because so many companies offer free plans for small projects. A <em>huge</em> thank you to all of these companies for making their tools so accessible.</p>\n<details>\n  <summary>Expand this if you want to read more about the non-Hasura parts of my stack.</summary>\n  </br>\n  I'm using a 1-5 ⭐ system for how highly I recommend each tool, and I've included some information about their financial situation so you can get a better sense of how likely they are to stick around. Hasura gets five stars from me (and they\n  <a href=\"https://hasura.io/blog/announcing-our-series-b-25m-financing/\" target=\"_blank\">raised a Series B in September 2020</a>).\n<p>  </br></br></p>\n<p>  ⭐⭐⭐⭐⭐ </p>\n<ul>\n<li><a href=\"https://vercel.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vercel</a> – Vercel is a “deployment and collaboration platform for frontend developers.” I’m hosting my frontend with them. They are the creators of the <a href=\"https://nextjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Next.js React framework</a> and also maintain <a href=\"https://github.com/geist-org/react\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Geist</a>, a minimal React UI library that I also use in my project. They last raised a <a href=\"https://vercel.com/blog/series-b-40m-to-build-the-next-web\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Series B round</a> in December 2020.</li>\n<li><a href=\"https://github.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub</a> – If you’re reading this, you probably already know about GitHub. You can host your code on GitHub, open and review pull requests there, etc. Every deploy to my <code class=\"language-text\">main</code> branch on GitHub automatically triggers a new Vercel deploy. I’m most familiar with GitHub, but other people love <a href=\"https://about.gitlab.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitLab</a>. They were <a href=\"https://news.microsoft.com/announcement/microsoft-acquires-github/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">acquired by Microsoft in 2018</a> for $7.5 billion.</li>\n</ul>\n<p>  ⭐⭐⭐⭐</p>\n<ul>\n<li><a href=\"https://getstream.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Stream</a> – Stream is a tool that makes it easier to build scalable in-app chat and activity feeds. I’m using it so everyone in a game can talk to each other over text chat. They <a href=\"https://getstream.io/blog/stream-series-b-funding-announcement/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">announced a Series B round</a> in March 2021 and shortly after released <a href=\"https://getstream.io/maker-account/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">a free plan for small businesses</a>.</li>\n<li><a href=\"https://sentry.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sentry</a> – Sentry is an application monitoring platform so you can get alerted of any errors in your app. Dead simple to integrate through Vercel. They last raised <a href=\"https://techcrunch.com/2021/02/18/app-monitoring-platform-sentry-gets-60-million-series-d-at-1-billion-valuation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">a Series D round</a> in February 2021. </li>\n<li><a href=\"https://heap.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Heap</a> – Heap is a product analytics tool that makes it easy to capture and understand your product usage data. They raised a <a href=\"https://heap.io/blog/company/our-55-million-series-c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Series C round</a> in July 2019.</li>\n<li><a href=\"https://www.heroku.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Heroku</a> – Heroku is a “cloud application platform” that makes it easy to deploy an app without spending too much time on infrastructure. I’m hosting my Postgres database with them. <a href=\"https://techcrunch.com/2010/12/08/breaking-salesforce-buys-heroku-for-212-million-in-cash/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Purchased by Salesforce</a> in 2010.</li>\n</ul>\n<p>  ⭐⭐⭐</p>\n<ul>\n<li><a href=\"https://jitsi.github.io/handbook/docs/dev-guide/dev-guide-iframe\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Jitsi</a> – An open-source video chat platform. You can even run your video chats on their servers, for free! Less capable than some competitors (like Zoom, who now offer a <a href=\"https://zoom.us/docs/en-us/video-sdk.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video SDK</a> that has a limited free plan) but incredible at the price point. Ownership has changed hands a bit, and was <a href=\"http://social.techcrunch.com/2018/10/29/atlassian-sells-jitsi-an-open-source-videoconferencing-tool-it-acquired-in-2015-to-8x8/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">last sold to 8×8 from Atlassian in 2018</a>.</li>\n<li>\n<p><a href=\"https://auth0.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Auth0</a> – An authentication provider that makes it easy enough to let users securely sign in to your app. It’s very nice to not worry too much about security, has its own login page I can redirect users to, and easily integrates with social login providers like Google. I don’t love their login page, so I might replace them with my own auth system. They were <a href=\"https://auth0.com/blog/okta-auth0-announcement/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sold to Okta for $6.5 billion</a> in March 2021.</p>\n</details>\n</li>\n</ul>\n<h2 id=\"self-hosting-hasura-graphql-engine-on-digitalocean\" style=\"position:relative;\"><a href=\"#self-hosting-hasura-graphql-engine-on-digitalocean\" aria-label=\"self hosting hasura graphql engine on digitalocean permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Self-Hosting Hasura GraphQL Engine on DigitalOcean</h2>\n<p>While the <a href=\"https://hasura.io/pricing/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">free tier of Hasura Cloud</a> is perfect for development, you are limited to 60 requests/minute. That’s <em>probably</em> not going to be enough for a production app. To get unlimited requests, you need to upgrade to the Standard tier which starts at $99/month. Because my site is more of a hobby project, I sought out a cheaper way to run my project in production.</p>\n<p>Helpfully, Hasura has documentation on how to <a href=\"https://hasura.io/docs/latest/graphql/core/deployment/deployment-guides/digital-ocean-one-click.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">easily deploy their GraphQL Engine</a> to <a href=\"https://www.digitalocean.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DigitalOcean</a>, where a virtual machine with 1 GB memory and 25 GB disk will run you $5/month. Seems like a good deal to me! </p>\n<h2 id=\"hosting-a-postgres-database-on-heroku\" style=\"position:relative;\"><a href=\"#hosting-a-postgres-database-on-heroku\" aria-label=\"hosting a postgres database on heroku permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hosting a Postgres Database on Heroku</h2>\n<p>Hasura additionally has a guide to <a href=\"https://hasura.io/docs/latest/graphql/core/deployment/deployment-guides/digital-ocean-one-click.html#using-digitalocean-managed-postgres-database\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">creating a DigitalOcean managed Postgres database</a>. But those start at a comparatively steep $15/month.</p>\n<p>Thankfully, it’s incredibly easy to create a free database hosted on <a href=\"https://www.heroku.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Heroku</a> when you create a new Hasura project. For the low price of free, you can store up to 1 GB across 10k rows. For $9/month, your storage limit dramatically increases to 10 GB across ten million rows.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQoz3WR2U7DMBBF+///gASvSPAZPAGiUjf6kJQ0TeKExPG+jO3i0LK0Ta2rkUea45k7nuRFsS3QtmqLllZYdlSg5rNp+xI1TYu1dcqAtuOaFGW1K6tNlnEpXQgWTAjgvA3BeQ8+gAFzFU7SNPk+7+v1rigJQVk6K/N1ls7zj+Vs+oQ7ZF1Qxo7AqG6iKoQqVHcYC20Jk0xqKhUVKtuVMWpwysKZBtiF/Z98sM7F4ZWCvlWcGi2dBW/dhcANcPR3puhVK9fVknSa9sZaf1lzhEc3wYSgglM+SCh1dWG/NxONAWiIfizhvGeso7SnjAl5rIGhZgSOS+kwEVRxHl8IAF4wJamWUnu/N8YxIjiRXU+kNidwbBWNFaS5XT4keLshRUaqab26WdwnOD+kb2h5t3qMPf7/2Q8MLrZ5aeZEC6x4jI3sn+tDyqgWtcCv9cKejv0FcVV1JXu/0FoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/02e911f8477bda3e2a694267b992520e/60a22/create-heroku-database.webp 160w,\n/static/02e911f8477bda3e2a694267b992520e/4c812/create-heroku-database.webp 320w,\n/static/02e911f8477bda3e2a694267b992520e/0ba47/create-heroku-database.webp 640w,\n/static/02e911f8477bda3e2a694267b992520e/e46b2/create-heroku-database.webp 960w,\n/static/02e911f8477bda3e2a694267b992520e/af3f0/create-heroku-database.webp 1280w,\n/static/02e911f8477bda3e2a694267b992520e/0b448/create-heroku-database.webp 1474w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/02e911f8477bda3e2a694267b992520e/69538/create-heroku-database.png 160w,\n/static/02e911f8477bda3e2a694267b992520e/72799/create-heroku-database.png 320w,\n/static/02e911f8477bda3e2a694267b992520e/6af66/create-heroku-database.png 640w,\n/static/02e911f8477bda3e2a694267b992520e/d9199/create-heroku-database.png 960w,\n/static/02e911f8477bda3e2a694267b992520e/21b4d/create-heroku-database.png 1280w,\n/static/02e911f8477bda3e2a694267b992520e/f3abf/create-heroku-database.png 1474w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/02e911f8477bda3e2a694267b992520e/6af66/create-heroku-database.png\"\n            alt=\"Create Heroku Database\"\n            title=\"Create Heroku Database\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>You might now be thinking, “If I’m going to host my database on Heroku, why don’t I just host Hasura GraphQL Engine on Heroku too?” Well, the approximate Heroku equivalent of a <a href=\"https://www.digitalocean.com/products/droplets/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DigitalOcean Droplet</a> is called a ”<a href=\"https://www.heroku.com/dynos\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dyno</a>,” and a dyno that doesn’t auto-sleep starts at $7/month. So a dyno is generally a bit more expensive than the Droplet-equivalent. Still, Heroku is a “Platform as a Service” while DigitalOcean is “Infrastructure as a Service”, so Heroku <em>does</em> offer you additional features for your money if you choose to go that route.</p>\n<h2 id=\"the-biggest-issue-with-these-hosting-choices\" style=\"position:relative;\"><a href=\"#the-biggest-issue-with-these-hosting-choices\" aria-label=\"the biggest issue with these hosting choices permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Biggest Issue With These Hosting Choices</h2>\n<p><strong>The biggest downside to this approach is that you must manually sync your Heroku database URL with your self-hosted Hasura GraphQL Engine.</strong> Before I implemented what I describe below, <strong>my site was unusable after Heroku maintenance</strong>.</p>\n<h3 id=\"why-you-need-this\" style=\"position:relative;\"><a href=\"#why-you-need-this\" aria-label=\"why you need this permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why You Need This</h3>\n<p>There is own major downside to a free Heroku database: maintenance. After maintenance, <em>your database credentials change</em>. So, <em>you must</em> update your database credentials in your self-hosted Hasura GraphQL Engine so your app can continue to connect to your database.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABb0lEQVQoz5WS227CQAxE9///rby1tEhAbk1CNiE3IEQobU92YItaCYl5sMaWL2PvmtXC5mEfvNXZtruM0/czMKtFEb3XHy92+1qNw4XQ1x3+uD54LX7c+z71f9y0bWNtWVX7/b4uy9Ja2zRN3/eQOI7HcYRUVUXweDzWdQ35nRyGIUm73S7LsiiKPh1wgyBYLpdJkmwdSCMBN89zerVtOxeTRIiC3IGkxCFNU5qKQ+hLBBs7aL7xedkNuAQZThDNpYMGsltRFPBhGOZiQmx4OBxQAu+6DhcOwZ7P50dPRVf66SpALpVY3U/DcRFlb8Dl4Gaz2SAPqVyFzbVS6qBbaCmIDgaQNk3TXKxT00x7so9cIE6NCKARcd7sKnu9XlPmj6z2fppUdA4M5Mgi12IcrqWbAbp6orzT6aQvhVT/W8WNnocH0HpSiCUoIiGSBtHyiJ93xuGfYPVUfEBui9U30iNDaITVE2Cl3GgTf4On8ANk54TcQQJXxQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/6333431b7bc3b2100c30a09a1714068b/60a22/heroku-maintenance-email.webp 160w,\n/static/6333431b7bc3b2100c30a09a1714068b/4c812/heroku-maintenance-email.webp 320w,\n/static/6333431b7bc3b2100c30a09a1714068b/0ba47/heroku-maintenance-email.webp 640w,\n/static/6333431b7bc3b2100c30a09a1714068b/e46b2/heroku-maintenance-email.webp 960w,\n/static/6333431b7bc3b2100c30a09a1714068b/260c2/heroku-maintenance-email.webp 1080w\" sizes=\"(max-width: 640px) 100vw, 640px\" type=\"image/webp\">\n          <source srcset=\"/static/6333431b7bc3b2100c30a09a1714068b/69538/heroku-maintenance-email.png 160w,\n/static/6333431b7bc3b2100c30a09a1714068b/72799/heroku-maintenance-email.png 320w,\n/static/6333431b7bc3b2100c30a09a1714068b/6af66/heroku-maintenance-email.png 640w,\n/static/6333431b7bc3b2100c30a09a1714068b/d9199/heroku-maintenance-email.png 960w,\n/static/6333431b7bc3b2100c30a09a1714068b/302a4/heroku-maintenance-email.png 1080w\" sizes=\"(max-width: 640px) 100vw, 640px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/6333431b7bc3b2100c30a09a1714068b/6af66/heroku-maintenance-email.png\" alt=\"Heroku Maintenance Notice\" title=\"Heroku Maintenance Notice\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n    </span>\n<p>Hasura Cloud offers ”<a href=\"https://hasura.io/docs/latest/graphql/cloud/projects/heroku-url-sync.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Heroku URL Sync</a>” to keep your project’s <code class=\"language-text\">HEROKU_DATABASE_URL</code> in sync. Unfortunately, this feature is only available for Hasura Cloud users. <em>Fortunately</em>, I’m about to tell you how to build this feature for your self-hosted Hasura GraphQL Engine. If all goes well, this should take you less than an hour. If it goes <em>really</em> well, it might only take you 15 minutes.</p>\n<h3 id=\"1-create-a-webhook-server\" style=\"position:relative;\"><a href=\"#1-create-a-webhook-server\" aria-label=\"1 create a webhook server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Create a Webhook Server</h3>\n<p><a href=\"https://zapier.com/blog/what-are-webhooks/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Webhooks</a> are a way for apps to send automated messages to other apps. In this case, <strong>we want Heroku to tell us when our database credentials change</strong> so we can update them in our GraphQL Engine.</p>\n<p>Adnan Hajdarević’s open-source <a href=\"https://github.com/adnanh/webhook#what-is-webhook-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webhook</a> tool makes it easy to spin-up a server that will receive event notifications via webhook. Your Droplet is probably running Ubuntu 18+, so after <a href=\"https://docs.digitalocean.com/products/droplets/how-to/connect-with-ssh/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SSH’ing into your Droplet</a>, you can install <code class=\"language-text\">webhook</code> with the following command:</p>\n<p><code class=\"language-text\">sudo apt-get install webhook</code></p>\n<p>Once <code class=\"language-text\">webhook</code> is installed, you’ll need to create a configuration file that defines the hooks that <code class=\"language-text\">webhook</code> will serve.</p>\n<p>Here’s what my <code class=\"language-text\">hooks.json</code> file looks like (except with correct paths, of course):</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"redeploy-webhook\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"execute-command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/path/to/redeploy.sh\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"command-working-directory\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/path/to/folder/with/docker-compose.yaml\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>When the webhook receives the new Heroku release event (we’ll get to that in the next section!) it executes the <code class=\"language-text\">redeploy.sh</code> script in the directory with our <code class=\"language-text\">docker-compose.yaml</code> file. Note that we don’t actually care about the event payload – we only care about knowing that something has changed with our Heroku database’s configuration and then running our script.</p>\n<p>Our script will fetch the new database URL from Heroku and parse the database password from the URL. It’ll then update our <code class=\"language-text\">.env</code> file with these new values. Finally, it will restart the Docker containers.</p>\n<p>Here’s what the <code class=\"language-text\">redeploy.sh</code> bash script looks like (make sure it’s excecutable by running <code class=\"language-text\">chmod +x redeploy.sh</code>):</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/sh</span>\n<span class=\"token assign-left variable\">URL</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>heroku config:get DATABASE_URL -a YOUR-HEROKU-APP-NAME<span class=\"token variable\">)</span></span>\n<span class=\"token assign-left variable\">PW</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">echo</span> $URL <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -Po <span class=\"token string\">\"[a-zA-Z0-9]+?(?=@)\"</span><span class=\"token variable\">)</span></span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"DATABASE_URI=<span class=\"token variable\">$URL</span><span class=\"token entity\" title=\"\\n\">\\n</span>DATABASE_PASSWORD=<span class=\"token variable\">$PW</span>\"</span> <span class=\"token operator\">></span> .env\ndocker-compose restart</code></pre></div>\n<p>Before this script will work, we need to install the Heroku CLI and authenticate ourselves. We can do this on Ubuntu with the following command:</p>\n<p><code class=\"language-text\">sudo snap install --classic heroku</code></p>\n<p>Then, run:</p>\n<p><code class=\"language-text\">heroku login -i</code></p>\n<p>and enter your login credentials. You’ll also need to replace <code class=\"language-text\">YOUR-HEROKU-APP-NAME</code> in <code class=\"language-text\">redeploy.sh</code> with the name of the app that has the <code class=\"language-text\">Heroku Postgres</code> add-on installed. You can use the Heroku CLI to get a list of all your Heroku apps by running <code class=\"language-text\">heroku apps</code>.</p>\n<p>Next, start the webhook server with the following command (be sure to replace <code class=\"language-text\">your-domain.com</code> with an address associated with the Droplet you’ve SSH’d into):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">webhook -hooks /path/to/hooks.json -ip &quot;your-domain.com&quot; -port 9003</code></pre></div>\n<p>The hook is now available at <a href=\"http://your-domain.com:9003/hooks/redeploy-webhook\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://your-domain.com:9003/hooks/redeploy-webhook</a></p>\n<p>Note that I’ve chosen port <code class=\"language-text\">9003</code> arbitrarily – I cannot vouch for this port beyond that it functionally works for my application and it’s not used by anything else. Also note that the webhook is currently using the insecure <code class=\"language-text\">http</code> protocol.</p>\n<p>To upgrade to <code class=\"language-text\">https</code> you need to find some certs (more on this in a moment) and then run the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">webhook -hooks /path/to/hooks.json -secure -cert /path/to/public.crt -key path/to/private.key -ip &quot;your-domain.com&quot; -port 9003</code></pre></div>\n<p>After running this command, your hook will be available at <a href=\"https://your-domain.com:9003/hooks/redeploy-webhook\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://your-domain.com:9003/hooks/redeploy-webhook</a> – much better!</p>\n<p>If you’ve deployed the Hasura GraphQL Engine with <a href=\"https://marketplace.digitalocean.com/apps/hasura-graphql\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the app on the DigitalOcean Marketplace</a>, one of its dependencies – <a href=\"https://caddyserver.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Caddy</a> – will automatically obtain and renew TLS certificates for you when you run <code class=\"language-text\">docker-compose up</code>. These certs are stored in a <a href=\"https://docs.docker.com/storage/volumes/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Docker Volume</a>, so you can peek in there to either provide a path to them <em>or</em> just copy them to a different directory. Do note that the <code class=\"language-text\">webhook</code> <code class=\"language-text\">-cert</code> flag expects a public key and the <code class=\"language-text\">-key</code> flag expects a private key. You can find <a href=\"https://github.com/adnanh/webhook/blob/master/docs/Webhook-Parameters.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the full documentation on <code class=\"language-text\">webhook parameters</code> here</a>.</p>\n<p>You will need to be a bit careful not to restart the Docker containers <em>too</em> often as it seems that Hasura’s DigitalOcean Marketplace app isn’t actually re-using TLS credentials across restarts; instead, it’s regenerating new certs each time. And you’re not going to have a great time if you run into <a href=\"https://letsencrypt.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Let’s Encrypt</a>’s <a href=\"https://letsencrypt.org/docs/rate-limits/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rate-limit</a>. Addressing this may be a topic of a future blog post. Anyway, the takeaways should be: 1. Consider removing the <code class=\"language-text\">docker-compose restart</code> line from your <code class=\"language-text\">redeploy.sh</code> file while you’re testing , and 2. You don’t want to hit this webhook <em>too</em> often.</p>\n<p>One last tip: when you run the above <code class=\"language-text\">webhook</code> command, add an <code class=\"language-text\">&amp;</code> to the end of it so the command runs in the background – you don’t want the server to stop after you’ve closed your shell session.</p>\n<h3 id=\"2-configure-docker-composeyaml-to-use-environment-variables\" style=\"position:relative;\"><a href=\"#2-configure-docker-composeyaml-to-use-environment-variables\" aria-label=\"2 configure docker composeyaml to use environment variables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Configure docker-compose.yaml to Use Environment Variables</h3>\n<p>This step should be refreshingly straightforward! Instead of directly setting <code class=\"language-text\">POSTGRES_PASSWORD</code> and <code class=\"language-text\">HASURA_GRAPHQL_DATABASE_URL</code> in <code class=\"language-text\">docker-compose.yaml</code>, you should access their values from <a href=\"https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">environment variables</a>. We already named these env vars in <code class=\"language-text\">redeploy.sh</code>, so you can reference them like so:</p>\n<p><code class=\"language-text\">POSTGRES_PASSWORD: &quot;${DATABASE_PASSWORD}&quot;</code></p>\n<p>and</p>\n<p><code class=\"language-text\">HASURA_GRAPHQL_DATABASE_URL: &quot;${DATABASE_URI}&quot;</code></p>\n<h3 id=\"3-tell-heroku-about-your-webhook-url\" style=\"position:relative;\"><a href=\"#3-tell-heroku-about-your-webhook-url\" aria-label=\"3 tell heroku about your webhook url permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Tell Heroku About Your Webhook URL</h3>\n<p>We’re in the home stretch!</p>\n<p>Navigate to your Heroku app running your Postgres database. The URL will look something like <a href=\"https://dashboard.heroku.com/apps/YOUR-HEROKU-APP-NAME\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://dashboard.heroku.com/apps/YOUR-HEROKU-APP-NAME</a></p>\n<p>Then, click <code class=\"language-text\">More</code> in the top-right and then <code class=\"language-text\">View webhooks</code>.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 111.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAIAAABPIytRAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfElEQVQ4y41T2XLbMAz0/39Yn/LQtB0nseNEtiXr5E2CpK50aSWuk4lnyoE4SwjHAiBXPgyLWBd5ayRzRpKRHmJ10IJYawRz0EvujPLQQHhrHfUrR3G9PWrrrQne9bzWD3fH466tjmJzX2jhtPRSOO8ijtljwypNNiKKMWFFvufCWoqM27qUXavzrK1LUZ3E4aVpa1UBl0Iw01QSemhYp7tGg2lyBgFtqB9G54I1PobRU+8pxjhoTc56R0FJZzQZQ1onoJRTxq+maXY++BCENOSj1jYv644LJmTT8Wma3r5bIfbG0QrI+0g+KOOs8zH2bSeE1NgPxxKhF+v5aiWXEFFqcg4hKmMtOLugjRMIQxFYKttxBUYdU6guxGGR2I/a0rszMiPn5uX0sq+rhv389fi0zR43r/e/nx6edgB/1s9KU4jjMlQA9Cg5T/MMzlLbvh8RchoTLVQKvvNZFox2wmCRYZis9eB4yUzjNA3j+0Kf/iHUPc9fG3apGZnRvd3+lOV13XTbXda0/JCXr/t885wJqZaGfe+8ZL78uJjBYfpo783MPs05lg2vGsGFLMq6rNq6YdjTzJgAi6rulrEtoT45gzlGAoH2PGSOKCBsjFMaAwPWN5xDxNwuVN9uLDgvAhMku6YdXg/VoWiIfNcJpY2xuHAkleYcJ/flnn7qduz79Wb/427tHD0jTN3mp3qfn4DzojoWFaxvNOw/aIPseIN2dOfsEDwMooDAy9EnmJTjLdpwhgXmIpRtGd/ssi1uTNWA7fmqFNmhQLe/PEm7PEkUDIQ9lT4M+NL+AUAJ6msZhoHO010t9aS3oQwXignFryQd5ScNBCyQDA/hL2ZX8G8v+cfCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/33434c836dc7ebdb70ee9f82f825be20/60a22/create-heroku-webhook-1-of-2.webp 160w,\n/static/33434c836dc7ebdb70ee9f82f825be20/4c812/create-heroku-webhook-1-of-2.webp 320w,\n/static/33434c836dc7ebdb70ee9f82f825be20/9d6da/create-heroku-webhook-1-of-2.webp 492w\" sizes=\"(max-width: 492px) 100vw, 492px\" type=\"image/webp\">\n          <source srcset=\"/static/33434c836dc7ebdb70ee9f82f825be20/69538/create-heroku-webhook-1-of-2.png 160w,\n/static/33434c836dc7ebdb70ee9f82f825be20/72799/create-heroku-webhook-1-of-2.png 320w,\n/static/33434c836dc7ebdb70ee9f82f825be20/5c6e9/create-heroku-webhook-1-of-2.png 492w\" sizes=\"(max-width: 492px) 100vw, 492px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/33434c836dc7ebdb70ee9f82f825be20/5c6e9/create-heroku-webhook-1-of-2.png\" alt=\"Create Heroku Webhook 1 of 2\" title=\"Create Heroku Webhook 1 of 2\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n    </span>\n<p>On the new page, click <code class=\"language-text\">Create Webhook</code>. Enter in your URL from before – in this case, <a href=\"https://your-domain.com:9003/hooks/redeploy-webhook\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://your-domain.com:9003/hooks/redeploy-webhook</a> – and only select the <code class=\"language-text\">api:release</code> event type. If you’d like to set a secret, refer to <a href=\"https://github.com/adnanh/webhook/blob/master/docs/Hook-Rules.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">the <code class=\"language-text\">webhook rules</code> documentation</a>.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 235.62499999999997%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAvCAIAAABsVn00AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEnUlEQVRIx5VWOY8kNRTu/0rIHyAhWDYiIGEQQhrildglQiAmQ4w224CIEM3RR5WPsl22q3zVwWfXzE7PbPf2TOnJeuXj+b3vXV6xRtmu16Yz9mFstcWotNG2N/vUZdKF2VR0hU3zPE/TNN9/4IVspdI15YQ1jIv91WWD7R2hzarVncI+0jSNwj+2ci4J4TVhxnQhRO9DDDHGlNIwDOM4TOOYZe1IsxLKCqV2lDIhasYJ5+A3db0lVBntY3DBe0iIwacQhhiHhBGHr3dsJbUJY1Ctgqa4FcI/qjdOuGZI+zSCUoSIKW4rvlLauuilVq3VjZJ9cD75UC7J94wHKAxhmIe7wwDmelNVhN1uqs2OXN2sY9/Px78Fv23NVy08EJ1oVdsZXUjBTa6zrpNGQaM82VvdG6iGSfy2nU5TqqlYKWNd6gmjQgn4RbSypoRyxgSvGQHBAxixYVttCSMVqWtG/Rjy4RwMreZSMSEpF3As/DJ/9lvUruDnHE/GcCWpaOBsjJ3v45gWwA4SfDbNU4Wb4SpAN8IvkDhP4zwNdy45StnVU8xqA7BhHrPrxpSeR9iMy6rF5iexffJ7ZPPyv0xN98tT4R+Yffp4WLZGCIHQrqoKPnrZzbAZnkZwCqnBI8mQzIXgQstFq00vsaoQLtZ2DpmMeaRXzYrNSG7KpFQGIcKlbqQmTOYd49D7gFRBLuaMLCmJEen5yOaEREWq5vHe+OMQPqitWuOdI0zcbsnNhnS9w1oRNUFWYfL4pNQ8uhkiBHI/m2egMAjmsabFJKwAHND2EGAa1iODkYUelbAwrit0TPM9tbVJEWWBXd1W6y293dLrdb2r+c2WQKkiYp4+HyTQKmVUR9yNy2ManA/QvHf+BGDWGFRvXA6Dy9qzg6QRLbhGaMoVFwoj3A6cEB4YD5q9b7MFtyhpC0j4xvvvVHi2JgQPnYHTpmKA4GSGPQXMhehKW8Dv0hCedRiu8t4BKhiP4gDkYPYxhQ/fDHjg2x3hlMuCHKzJWQXMIBdxevzwNMHJWevSzbCwBDOGki3DPE9H/YxOBqiu1hUSA5UJEQIhIffGtB/SxwHzMceWD2gQsmTIkhLL6nFXaRsjumQOMgTbC8uQtrAMIAGtikAAqlLflB4FqMCfVhu2wUIQlAdsMHtJlYM++7SSSGCGromsXIIsl6tSsZa6VZg8xnQn8eFm6IkIWaBCksDJuSQrjRlonkNI4oWCTmxoI5EIjw5D25wVp0D6JCVV92E9l0ZrAThKxwvQlm13q/IbYbGZoHAbvOP6zkEXD42Q3m1uwxDr4Xx4J5VHz6J29i36Q7YZJjGJ9ASPNYAH52Hc7OgaDywu+yzOoU3mw6TYjAdT33mL2zokWOhQFUyP1wnKKGBGmDqXgw8BO+4V8HxYSpPCsPQK2zpe4/USIA57wJx/c/Htl+/OX/0J5ufXF2DOvvrt9Rdv3v/+rzAalcTO0GLM5G3UAm+jlH+nObj064/vz19d/PL932/PLt/+cPnu7PLNd3/99PUf/1z+J7RewTaUAUIFrOWNamTLuAJPKR6EbR+9S966HmQKdTCizFyvq/8Bm/OR8JV6KdcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/3d7832b165fe0ca1641d5ecf66707258/60a22/create-heroku-webhook-2-of-2.webp 160w,\n/static/3d7832b165fe0ca1641d5ecf66707258/4c812/create-heroku-webhook-2-of-2.webp 320w,\n/static/3d7832b165fe0ca1641d5ecf66707258/0ba47/create-heroku-webhook-2-of-2.webp 640w,\n/static/3d7832b165fe0ca1641d5ecf66707258/b2a51/create-heroku-webhook-2-of-2.webp 830w\" sizes=\"(max-width: 640px) 100vw, 640px\" type=\"image/webp\">\n          <source srcset=\"/static/3d7832b165fe0ca1641d5ecf66707258/69538/create-heroku-webhook-2-of-2.png 160w,\n/static/3d7832b165fe0ca1641d5ecf66707258/72799/create-heroku-webhook-2-of-2.png 320w,\n/static/3d7832b165fe0ca1641d5ecf66707258/6af66/create-heroku-webhook-2-of-2.png 640w,\n/static/3d7832b165fe0ca1641d5ecf66707258/715a3/create-heroku-webhook-2-of-2.png 830w\" sizes=\"(max-width: 640px) 100vw, 640px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/3d7832b165fe0ca1641d5ecf66707258/6af66/create-heroku-webhook-2-of-2.png\" alt=\"Create Heroku Webhook 2 of 2\" title=\"Create Heroku Webhook 2 of 2\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n    </span>\n<p>To test your setup, you can create a new config var in your Heroku app. To do this, navigate to the <code class=\"language-text\">Settings</code> tab in your Heroku app, click <code class=\"language-text\">Reveal Config Vars</code> and create a new key. It doesn’t matter what you put in as the key name – we just want to create a new release so Heroku calls your webhook.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQoz41SC07DMAzNzbd87djtYOcBbgDiDoDG1g7OwHNKgdExYUWRnfjlPdtxfpVzohQp+Bxi9j4RMZFgMf9exNWSQ0F+yezETNsutc6+KvzK0i1MdXa6zi2TVJWZ9Svrb3NIUtEFuEI8dtNg1p19yi2PqplsNn3JOZdyQcJZsJRCkwNysP8X3DdMjAmEUJ5SYZNvWqy+VsYl5omzpWrrvzQ8T6GB+643s4bNPqIfPfvWcmIIO6n4BdZL5330IcWUU8rA2J1IiAlc2l6RJgHKufECVApTgZTqoAhDaYPhuea6Wvu1DyGi9oSbXGjtI0IfsCeMoP2o6k40zUqn54inmV3hxP4Slny2bHu97fvNScOAJ6Kb27vj2/thGIZxHMbjOB5fdq+7/QHOdLI/DE/Pr/cPjx/e07N2M+JhTQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a511cca3200f52aa91aa8ffeace62320/60a22/heroku-set-config-var.webp 160w,\n/static/a511cca3200f52aa91aa8ffeace62320/4c812/heroku-set-config-var.webp 320w,\n/static/a511cca3200f52aa91aa8ffeace62320/0ba47/heroku-set-config-var.webp 640w,\n/static/a511cca3200f52aa91aa8ffeace62320/e46b2/heroku-set-config-var.webp 960w,\n/static/a511cca3200f52aa91aa8ffeace62320/af3f0/heroku-set-config-var.webp 1280w,\n/static/a511cca3200f52aa91aa8ffeace62320/ad234/heroku-set-config-var.webp 2310w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a511cca3200f52aa91aa8ffeace62320/69538/heroku-set-config-var.png 160w,\n/static/a511cca3200f52aa91aa8ffeace62320/72799/heroku-set-config-var.png 320w,\n/static/a511cca3200f52aa91aa8ffeace62320/6af66/heroku-set-config-var.png 640w,\n/static/a511cca3200f52aa91aa8ffeace62320/d9199/heroku-set-config-var.png 960w,\n/static/a511cca3200f52aa91aa8ffeace62320/21b4d/heroku-set-config-var.png 1280w,\n/static/a511cca3200f52aa91aa8ffeace62320/828bd/heroku-set-config-var.png 2310w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a511cca3200f52aa91aa8ffeace62320/6af66/heroku-set-config-var.png\"\n            alt=\"Set Heroku Config Var\"\n            title=\"Set Heroku Config Var\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Hopefully, you’re all set! You can double-check by navigating to the directory with your <code class=\"language-text\">docker-compose.yaml</code> file and seeing that the <code class=\"language-text\">.env</code> file matches your Heroku database credentials.</p>\n<p>Now, any Heroku database maintenance will not be much of a problem for you or your app (except for a few seconds of downtime while the credentials are updated).</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>I hope you found this guide helpful! Again, if you have any suggestions or comments, please email me at <a href=\"mailto:bhollander823@gmail.com?subject=Your Hasura Article\">bhollander823@gmail.com</a> 👋</p>","fields":{"slug":"/posts/running-hasura-cheaply","tagSlugs":["/tag/dev-ops/","/tag/hasura/","/tag/graph-ql/","/tag/postgres/","/tag/web-development/"]},"frontmatter":{"date":"2020-04-19T12:40:32.169Z","description":"Side-project ready realtime GraphQL API over Postgres for just $5/month.","tags":["DevOps","Hasura","GraphQL","Postgres","Web Development"],"title":"Running Hasura on the Cheap","socialImage":{"publicURL":"/static/bdaf6935507aea31c799075b0576efc0/hasura-landing.png"}}}},"pageContext":{"slug":"/posts/running-hasura-cheaply"}},"staticQueryHashes":["251939775","3439816877","401334301"]}